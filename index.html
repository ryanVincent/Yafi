<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Jules by ryanVincent</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Jules</h1>
      <h2 class="project-tagline">FLUX Architecture Implementation</h2>
      <a href="https://github.com/ryanVincent/jules" class="btn">View on GitHub</a>
      <a href="https://github.com/ryanVincent/jules/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/ryanVincent/jules/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="julesjs" class="anchor" href="#julesjs" aria-hidden="true"><span class="octicon octicon-link"></span></a>jules.js</h1>

<h2>
<a id="description" class="anchor" href="#description" aria-hidden="true"><span class="octicon octicon-link"></span></a>Description</h2>

<p>Jules.js is an implementation of the FLUX Architecture. I decided to implement the specification in order to gain a deeper understanding of the framework and have a small library I know well and could edit when necessary. </p>

<h2>
<a id="getting-started" class="anchor" href="#getting-started" aria-hidden="true"><span class="octicon octicon-link"></span></a>Getting started</h2>

<p>Download the latest build and then include jules in your project like so:</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">&lt;</span>script src<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>/location/of/jules-min.js<span class="pl-pds">"</span></span><span class="pl-k">&gt;&lt;/</span>script<span class="pl-k">&gt;</span></pre></div>

<p>Jules exposes 5 classes that aid in the implementation of the FLUX architecture within a project:
*Action
*Dispatcher
*Emitter
*Store
*WebAPI</p>

<h2>
<a id="data-flow" class="anchor" href="#data-flow" aria-hidden="true"><span class="octicon octicon-link"></span></a>Data flow</h2>

<p>The data flow in a flux application is unidirectional. Actions come from external sources such as the user or the server and are always collected by the Dispatcher. Stores listen to the Dispatcher and react to new data coming through the pipeline. If the action has caused the Store to alter it's internal state then the Store emits a change using it's Emitter. Application views can choose to listen to a store for changes and when a Store changes can query it's internal state.</p>

<p><img src="http://blog.krawaller.se/img/flux-diagram.png" alt="Flux Diagram"></p>

<h2>
<a id="dispatcher" class="anchor" href="#dispatcher" aria-hidden="true"><span class="octicon octicon-link"></span></a>Dispatcher</h2>

<p>Your application should contain a single instance of the Dispatcher class. Any and all actions should be routed through the dispatcher via <code>dispatcher.dispatch(action);</code>.</p>

<h3>
<a id="methods" class="anchor" href="#methods" aria-hidden="true"><span class="octicon octicon-link"></span></a>methods</h3>

<p>The dispatcher class exposes the following methods: </p>

<table>
<thead>
<tr>
<th>Signature</th>
<th>Description</th>
<th>Returns</th>
</tr>
</thead>
<tbody>
<tr>
<td>dispatch(action :Object or Action)</td>
<td>dispatches an action to any registered callbacks.</td>
<td>void</td>
</tr>
<tr>
<td>isDispatching()</td>
<td>returns true if the dispatcher is currently in the process of dispatching events.</td>
<td>true if currently dispatching.</td>
</tr>
<tr>
<td>register(callback)</td>
<td>Registers a callback which is invoked everytime an action is dispatched.</td>
<td>a token used to reference the callback.</td>
</tr>
<tr>
<td>unregister(token)</td>
<td>Unregisters a callback</td>
<td>void</td>
</tr>
<tr>
<td>waitFor(string[])</td>
<td>Wait for a a set of calbacks to be completed before continuing.</td>
<td>void</td>
</tr>
</tbody>
</table>

<h3>
<a id="example" class="anchor" href="#example" aria-hidden="true"><span class="octicon octicon-link"></span></a>example</h3>

<p>Instantiate: </p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> AppDispatcher <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Dispatcher</span>();</pre></div>

<p>Register a callback which will be called when an action is dispatched: </p>

<pre><code>AppDispatcher.register(function(action){
  console.log(action);
});
</code></pre>

<p>Dispatch an action to any listening callbacks: </p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> action <span class="pl-k">=</span> {say<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>hello<span class="pl-pds">"</span></span>};
AppDispatcher.dispatch(action);
<span class="pl-c">// -&gt; {say: "hello"}</span></pre></div>

<h2>
<a id="store" class="anchor" href="#store" aria-hidden="true"><span class="octicon octicon-link"></span></a>Store</h2>

<p>Stores are used to store information about your applications state. They should be regarded as the single source of truth in your application. A Store's state should never be edited by an external source instead the Store should implement it's own methods for manipulating it's state and these methods should be registered with the dispatcher using <code>addDispatchListener(callback)</code> method.</p>

<h3>
<a id="methods-1" class="anchor" href="#methods-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>methods</h3>

<p>The store class exposes the following methods: </p>

<table>
<thead>
<tr>
<th>Signature</th>
<th>Description</th>
<th>Returns</th>
</tr>
</thead>
<tbody>
<tr>
<td>getState()</td>
<td>Returns the current state of the Store.</td>
<td>current state of the store.</td>
</tr>
<tr>
<td>setState(state)</td>
<td>Use this method to update the internal state of the Store. Should only be called from within a callback registered by addDispatchListener.</td>
<td>void</td>
</tr>
<tr>
<td>addDispatchListener(callback)</td>
<td>Used to listen for actions coming from the dispatcher.</td>
<td>token {String} token representing the callback</td>
</tr>
<tr>
<td>removeDispatchListener(token)</td>
<td>Used to remove a dispatchListener. This listener will no longer be invoked when the Dispatcher dispatches actions to the Stores.</td>
<td>void</td>
</tr>
<tr>
<td>getDispatcherToken()</td>
<td>gets the dispatcher token for the store. Can be used by <code>dispatcher.waitFor()</code> to wait for this Store to complete it's callbacks.</td>
<td>token {String} token representing the Store.</td>
</tr>
<tr>
<td>emit(type)</td>
<td>Lets any view that is listening know that a change has occured in this store.</td>
<td>void</td>
</tr>
<tr>
<td>on(type, callback)</td>
<td>Used by views to listen for updates to the Store via it's emitter.</td>
<td>void</td>
</tr>
</tbody>
</table>

<h3>
<a id="example-1" class="anchor" href="#example-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>example</h3>

<p>Instantiate Store.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> AppDispatcher <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Dispatcher</span>();
<span class="pl-k">var</span> TodoStore <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Store</span>(AppDispatcher);</pre></div>

<p>create a method that will handle dispatched actions.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-c1">TodoStore</span>.<span class="pl-en">handleAddItem</span> <span class="pl-k">=</span> <span class="pl-k">function</span>(<span class="pl-smi">action</span>){
  <span class="pl-k">switch</span>(action.<span class="pl-c1">type</span>){
    <span class="pl-k">case</span> <span class="pl-s"><span class="pl-pds">'</span>ADD_ITEM<span class="pl-pds">'</span></span> <span class="pl-k">:</span> 
      <span class="pl-k">var</span> items <span class="pl-k">=</span> {};
      items[action.payload.<span class="pl-c1">id</span>] <span class="pl-k">=</span> action.payload;
      <span class="pl-v">this</span>.setState({items<span class="pl-k">:</span> items});
      <span class="pl-v">this</span>.emit(<span class="pl-s"><span class="pl-pds">'</span>change<span class="pl-pds">'</span></span>); <span class="pl-c">//calls any functions that are registered via .on('change', fn).</span>
  }
}</pre></div>

<p>Set that method as a dispatch listener</p>

<div class="highlight highlight-source-js"><pre>TodoStore.addDispatchListener(TodoStore.handleAddItem);</pre></div>

<p>Within your view component or wherever you rely on the Store's state.</p>

<pre lang="javascipt"><code>Todo.on('change', function(){
  var items = TodoStore.getState().items;
  console.log(items);
});
</code></pre>

<p>Dispatch the action to the Stores.</p>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> action <span class="pl-k">=</span> {
  type<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>ADD_ITEM<span class="pl-pds">'</span></span>,
  id<span class="pl-k">:</span> <span class="pl-c1">1234</span>,
  text<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>Finish writing docs.<span class="pl-pds">'</span></span>
};
AppDispatcher.dispatch(action);
<span class="pl-c">/* -&gt; {items: </span>
<span class="pl-c">        {</span>
<span class="pl-c">          1234: {type: 'ADD_ITEM', id: 1234, text 'Finish writing docs.'}</span>
<span class="pl-c">        }</span>
<span class="pl-c">       } </span>
<span class="pl-c">*/</span></pre></div>

<h2>
<a id="action-optional" class="anchor" href="#action-optional" aria-hidden="true"><span class="octicon octicon-link"></span></a>Action (Optional)</h2>

<p>The Action class is an optional class which can be used to standardize actions within your application. </p>

<h3>
<a id="properties" class="anchor" href="#properties" aria-hidden="true"><span class="octicon octicon-link"></span></a>properties</h3>

<p>The Action class exposes the following methods: </p>

<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>origin</td>
<td>string</td>
<td>the origin of the action e.g "user" or "server"</td>
<td>"unknown"</td>
</tr>
<tr>
<td>type</td>
<td>string</td>
<td>this field can be used by stores to decide how to handle an action. Example values: 'ADD_ITEM'. 'ITEM_ADDED', 'DELETE_ITEM'</td>
<td>"standard_action"</td>
</tr>
<tr>
<td>payload</td>
<td>Any</td>
<td>The information associated with the action. Anything can be passed into this parameter (it is recommended that a standard object is used).</td>
<td>passed in via constructor argument</td>
</tr>
<tr>
<td>error</td>
<td>Boolean</td>
<td>Whether or not the action represents an application error.</td>
<td>false</td>
</tr>
</tbody>
</table>

<h3>
<a id="example-2" class="anchor" href="#example-2" aria-hidden="true"><span class="octicon octicon-link"></span></a>example</h3>

<div class="highlight highlight-source-js"><pre><span class="pl-k">var</span> payload <span class="pl-k">=</span> {id<span class="pl-k">:</span> <span class="pl-c1">1234</span>, text<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>Finish the docs.<span class="pl-pds">'</span></span>}

<span class="pl-k">const</span> <span class="pl-c1">ADD_ITEM</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>add_item<span class="pl-pds">"</span></span>;
<span class="pl-k">const</span> <span class="pl-c1">USER</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>user<span class="pl-pds">"</span></span>;

<span class="pl-k">var</span> addItemAction <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">Action</span>(payload);
addItemAction.<span class="pl-c1">type</span> <span class="pl-k">=</span> <span class="pl-c1">ADD_ITEM</span>;
addItemAction.origin <span class="pl-k">=</span> <span class="pl-c1">USER</span>;

appDispatcher.dispatch(addItemAction);</pre></div>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/ryanVincent/jules">Jules</a> is maintained by <a href="https://github.com/ryanVincent">ryanVincent</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
